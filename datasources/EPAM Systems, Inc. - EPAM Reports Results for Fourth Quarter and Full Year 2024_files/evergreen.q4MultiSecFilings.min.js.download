(l=>{l.widget("evergreen.q4MultiSecFilings",l.evergreen.q4Sec,{options:{stockInfo:[],pdfPreference:"both",contentType:{itemsUrl:["/Services/SECFilingService.svc/GetEdgarFilingList","/feed/SECFiling.svc/GetEdgarFilingList"],yearsUrl:["/Services/SECFilingService.svc/GetEdgarFilingYearList","/feed/SECFiling.svc/GetEdgarFilingYearList"],itemsResultField:"GetEdgarFilingListResult",yearsResultField:"GetEdgarFilingYearListResult",buildParams:function(e){return{formGroupIdList:e.filingGroups.join(","),filingTypeList:e.filingTypes.join(","),excludeNoDocuments:e.excludeNoDocuments,includeHtmlDocument:e.includeHtmlDocument}},getFileType(e){switch(e){case"PDF":case"CONVPDF":return"pdf";case"RTF":case"CONVTEXT":return"word";case"XLS":return"excel";case"HTML":case"XBRL_HTML":return"html";case"XBRL":return"zip"}return e.toLowerCase()},parseItem:function(t,e){var n,r,i={id:e.FilingId,description:this._truncate(e.FilingDescription,t.titleLength),url:e.LinkToDetailPage,dateObj:new Date(e.FilingDate),year:new Date(e.FilingDate).getFullYear(),date:this._formatDate(e.FilingDate),agent:e.FilingAgentName,person:e.ReportPersonName,type:e.FilingTypeMnemonic,docs:[]},e=l.map(e.DocumentList,function(e){return{docId:e.FilingDocumentId,docType:e.DocumentType,docUrl:e.Url.replace(/(\w+:)/,""),urlFileType:t.contentType.getFileType(e.DocumentType)}});return 0<e.length&&(n=e.filter(e=>"CONVPDF"===e.docType),r=e.filter(e=>"PDF"===e.docType),"converted"===t.pdfPreference&&0<n.length?i.docs=e.filter(e=>"PDF"!==e.docType):"complimentary"===t.pdfPreference&&0<r.length?i.docs=e.filter(e=>"CONVPDF"!==e.docType):i.docs=e),i}}},_fetchItems(e){var t,r=this,i=this.options,n=r._usePublic()?1:0,c=l.Deferred(),s=l.grep(this.currentTags,function(e){return 0<e.length}),o=this._usePublic()?{pageSize:i.limit||-1,pageNumber:i.skip,tagList:s.join("|"),includeTags:!0,year:i.fetchAllYears?-1:e,excludeSelection:i.excludeSelection?0:1}:{serviceDto:{ItemCount:i.limit||-1,StartIndex:i.skip,TagList:s,IncludeTags:!0},excludeSelection:i.excludeSelection?0:1,year:i.fetchAllYears?-1:e};return l.isArray(i.stockInfo)&&0!=i.stockInfo.length?(t=[],i.stockInfo.forEach(e=>{e=this._callApi(this.contentType.itemsUrl[n],l.extend(!0,this._buildParams(),this.contentType.buildParams.call(this,i),o,{exchange:e.Exchange,symbol:e.Symbol}));t.push(e)}),l.when.apply(l,t).done(function(){var e=[];if("success"===arguments[1])e=arguments[0][r.contentType.itemsResultField];else for(var t=0;t<arguments.length;t++)e=e.concat(arguments[t][0][r.contentType.itemsResultField]);var n=r._processItems(e),n=r._filterByYears(n);0!==i.docOrder&&void 0!==i.docOrder&&l.each(n,function(e,n){l.each(i.docOrder,function(e,t){l.grep(n.docs,function(e){return e.docType==t}).length||n.docs.push({docType:t,docUrl:"",docEmpty:!0})}),n.docs.sort(function(e,t){e=l.inArray(e.docType,i.docOrder),t=l.inArray(t.docType,i.docOrder);return e<t?-1:t<e?1:0})}),c.resolve(n)}),c):c.resolve([])},_processItems(e){var t=this,n=this.options,e=l.map(e,function(e){return t.contentType.parseItem.call(t,n,e)});return(e=l.grep(e,function(e){return(!n.minDate||e.dateObj>=n.minDate)&&(!n.maxDate||e.dateObj<=n.maxDate)})).sort(function(e,t){return(t.dateObj-e.dateObj)*(n.sortAscending?-1:1)}),e},_filterByYears(e){var n,t=this.options;return 0<t.numOfYears&&-1==year?((n=_.years||[]).length||(l.each(e,function(e,t){-1==l.inArray(t.year,n)&&n.push(t.year)}),t.numOfYears<n.length&&(n=n.slice(0,t.numOfYears))),l.grep(e,function(e){return!t.numOfYears||!n.length||-1<l.inArray(e.year,n)})):e}})})($tudio);